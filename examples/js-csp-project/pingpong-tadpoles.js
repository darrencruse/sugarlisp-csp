// Generated by SugarLisp v0.6.5
var csp = require("js-csp");
var chan = csp.chan;
var timeout = csp.timeout;
var alts = csp.alts;

function* player(name, table) {
  var ball = undefined;

  while ((ball !== csp.CLOSED)) {
    var ball = yield csp.take(table);
    if ((ball !== csp.CLOSED)) {
      (ball.hits += 1);
      console.log(((name + " ") + ball.hits));
      var t = yield csp.take(timeout(100));
      yield csp.put(table, ball);
    };
  };
  console.log((name + ": table's gone"));
}

csp.go(function*() {
  var table = chan();

  csp.go(player, ["ping", table]);
  csp.go(player, ["pong", table]);
  yield csp.put(table, {
    hits: 0
  });
  var t = yield csp.take(timeout(1000));
  return table.close();

});